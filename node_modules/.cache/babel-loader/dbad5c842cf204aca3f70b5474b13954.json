{"ast":null,"code":"import _slicedToArray from \"/Users/nikhilvenkatraman/Desktop/projects/twilio-video-react-hooks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/nikhilvenkatraman/Desktop/projects/twilio-video-react-hooks/src/Login.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport OktaSignIn from '@okta/okta-signin-widget';\n\nvar Login = function Login(_ref) {\n  var handleSubmit = _ref.handleSubmit;\n  var OKTA_SETTINGS = {\n    \"baseUrl\": \"\".concat(process.env.REACT_APP_OKTA_ORG_URL),\n    \"clientId\": \"\".concat(process.env.REACT_APP_OKTA_CLIENT_ID),\n    \"issuer\": \"\".concat(process.env.REACT_APP_OKTA_ORG_URL, \"/oauth2/default\")\n  };\n  var okta = new OktaSignIn({\n    baseUrl: OKTA_SETTINGS.baseUrl,\n    clientId: OKTA_SETTINGS.clientId,\n    authParams: {\n      issuer: OKTA_SETTINGS.issuer,\n      responseType: [\"token\", \"id_token\"],\n      display: \"page\"\n    }\n  });\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState({\n    email: '',\n    firstName: '',\n    lastName: '',\n    login: '',\n    mobilePhone: '',\n    secondEmail: ''\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var showLogin = function showLogin() {\n    okta.remove();\n    okta.renderEl({\n      \"el\": \"#okta-login-container\"\n    }, function (res) {\n      console.log(res);\n    }, function (err) {\n      console.log(err);\n    });\n  };\n\n  useEffect(function () {\n    if (okta.hasTokensInUrl()) {\n      okta.authClient.token.parseFromUrl().then(function (data) {\n        okta.authClient.tokenManager.add('accessToken', data[0]);\n        okta.authClient.tokenManager.add('idToken', data[1]);\n      });\n    }\n\n    okta.authClient.session.get().then(function (res) {\n      if (res.status === 'ACTIVE') {\n        setIsAuthenticated(true);\n        res.user().then(function (userData) {\n          setUser(userData.profile);\n          handleSubmit(userData.profile.email);\n        });\n      } else {\n        showLogin();\n      }\n    });\n  }, [isAuthenticated]);\n\n  var logout = function logout() {\n    okta.authClient.session.close();\n    showLogin();\n    setIsAuthenticated(false);\n  };\n\n  if (isAuthenticated) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }, \"Hello \", user.firstName, \" \"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: logout,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }\n    }, \" logout\"));\n  } else {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      id: \"okta-login-container\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 7\n      }\n    });\n  }\n};\n\nexport default Login;","map":{"version":3,"sources":["/Users/nikhilvenkatraman/Desktop/projects/twilio-video-react-hooks/src/Login.js"],"names":["React","useState","useEffect","OktaSignIn","Login","handleSubmit","OKTA_SETTINGS","process","env","REACT_APP_OKTA_ORG_URL","REACT_APP_OKTA_CLIENT_ID","okta","baseUrl","clientId","authParams","issuer","responseType","display","isAuthenticated","setIsAuthenticated","email","firstName","lastName","login","mobilePhone","secondEmail","user","setUser","showLogin","remove","renderEl","res","console","log","err","hasTokensInUrl","authClient","token","parseFromUrl","then","data","tokenManager","add","session","get","status","userData","profile","logout","close"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA0C,OAA1C;AACA,OAAOC,UAAP,MAAuB,0BAAvB;;AAEA,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAER;AAAA,MADJC,YACI,QADJA,YACI;AACJ,MAAIC,aAAa,GAAG;AAClB,yBAAcC,OAAO,CAACC,GAAR,CAAYC,sBAA1B,CADkB;AAElB,0BAAeF,OAAO,CAACC,GAAR,CAAYE,wBAA3B,CAFkB;AAGlB,wBAAaH,OAAO,CAACC,GAAR,CAAYC,sBAAzB;AAHkB,GAApB;AAMA,MAAIE,IAAI,GAAG,IAAIR,UAAJ,CAAe;AACxBS,IAAAA,OAAO,EAAEN,aAAa,CAACM,OADC;AAExBC,IAAAA,QAAQ,EAAEP,aAAa,CAACO,QAFA;AAGxBC,IAAAA,UAAU,EAAE;AACVC,MAAAA,MAAM,EAAET,aAAa,CAACS,MADZ;AAEVC,MAAAA,YAAY,EAAE,CAAC,OAAD,EAAU,UAAV,CAFJ;AAGVC,MAAAA,OAAO,EAAE;AAHC;AAHY,GAAf,CAAX;;AAPI,kBAiB0ChB,QAAQ,CAAC,KAAD,CAjBlD;AAAA;AAAA,MAiBGiB,eAjBH;AAAA,MAiBoBC,kBAjBpB;;AAAA,mBAmBoBlB,QAAQ,CAAC;AAC/BmB,IAAAA,KAAK,EAAE,EADwB;AAE/BC,IAAAA,SAAS,EAAE,EAFoB;AAG/BC,IAAAA,QAAQ,EAAE,EAHqB;AAI/BC,IAAAA,KAAK,EAAE,EAJwB;AAK/BC,IAAAA,WAAW,EAAE,EALkB;AAM/BC,IAAAA,WAAW,EAAE;AANkB,GAAD,CAnB5B;AAAA;AAAA,MAmBGC,IAnBH;AAAA,MAmBSC,OAnBT;;AA4BJ,MAAMC,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtBjB,IAAAA,IAAI,CAACkB,MAAL;AACAlB,IAAAA,IAAI,CAACmB,QAAL,CAAc;AAAE,YAAO;AAAT,KAAd,EACA,UAASC,GAAT,EAAc;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,KAHD,EAIA,UAASG,GAAT,EAAc;AACZF,MAAAA,OAAO,CAACC,GAAR,CAAYC,GAAZ;AACD,KAND;AAOD,GATD;;AAWAhC,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIS,IAAI,CAACwB,cAAL,EAAJ,EAA2B;AACzBxB,MAAAA,IAAI,CAACyB,UAAL,CAAgBC,KAAhB,CAAsBC,YAAtB,GACCC,IADD,CACO,UAACC,IAAD,EAAU;AACf7B,QAAAA,IAAI,CAACyB,UAAL,CAAgBK,YAAhB,CAA6BC,GAA7B,CAAiC,aAAjC,EAAgDF,IAAI,CAAC,CAAD,CAApD;AACA7B,QAAAA,IAAI,CAACyB,UAAL,CAAgBK,YAAhB,CAA6BC,GAA7B,CAAiC,SAAjC,EAA4CF,IAAI,CAAC,CAAD,CAAhD;AACD,OAJD;AAKD;;AACD7B,IAAAA,IAAI,CAACyB,UAAL,CAAgBO,OAAhB,CAAwBC,GAAxB,GAA8BL,IAA9B,CAAmC,UAACR,GAAD,EAAS;AAC1C,UAAIA,GAAG,CAACc,MAAJ,KAAe,QAAnB,EAA6B;AAC3B1B,QAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAY,QAAAA,GAAG,CAACL,IAAJ,GAAWa,IAAX,CAAgB,UAACO,QAAD,EAAc;AAC5BnB,UAAAA,OAAO,CAACmB,QAAQ,CAACC,OAAV,CAAP;AACA1C,UAAAA,YAAY,CAACyC,QAAQ,CAACC,OAAT,CAAiB3B,KAAlB,CAAZ;AACD,SAHD;AAID,OAND,MAMO;AACLQ,QAAAA,SAAS;AACV;AACF,KAVD;AAWD,GAnBQ,EAmBN,CAACV,eAAD,CAnBM,CAAT;;AAqBA,MAAM8B,MAAM,GAAG,SAATA,MAAS,GAAM;AACnBrC,IAAAA,IAAI,CAACyB,UAAL,CAAgBO,OAAhB,CAAwBM,KAAxB;AACArB,IAAAA,SAAS;AACTT,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;AAED,GALD;;AAQA,MAAID,eAAJ,EAAqB;AACnB,wBACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAYQ,IAAI,CAACL,SAAjB,MADF,eAEE;AAAQ,MAAA,OAAO,EAAE2B,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAFF,CADF;AAMD,GAPD,MAOO;AACL,wBACE;AAAK,MAAA,SAAS,EAAC,KAAf;AAAqB,MAAA,EAAE,EAAC,sBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAID;AACF,CAnFD;;AAqFA,eAAe5C,KAAf","sourcesContent":["import React, { useState, useEffect} from 'react';\nimport OktaSignIn from '@okta/okta-signin-widget';\n\nconst Login = ({\n  handleSubmit,\n}) => {\n  var OKTA_SETTINGS = {\n    \"baseUrl\": `${process.env.REACT_APP_OKTA_ORG_URL}`,\n    \"clientId\": `${process.env.REACT_APP_OKTA_CLIENT_ID}`,\n    \"issuer\": `${process.env.REACT_APP_OKTA_ORG_URL}/oauth2/default`,\n  };\n\n  var okta = new OktaSignIn({\n    baseUrl: OKTA_SETTINGS.baseUrl,\n    clientId: OKTA_SETTINGS.clientId,\n    authParams: {\n      issuer: OKTA_SETTINGS.issuer,\n      responseType: [\"token\", \"id_token\"],\n      display: \"page\"\n    }\n  });\n\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n  const [user, setUser] = useState({\n    email: '',\n    firstName: '',\n    lastName: '',\n    login: '',\n    mobilePhone: '',\n    secondEmail: ''\n  });\n\n  const showLogin = () => {\n    okta.remove();\n    okta.renderEl({ \"el\" : \"#okta-login-container\" }, \n    function(res) {\n      console.log(res);\n    }, \n    function(err) {\n      console.log(err);\n    });\n  };\n\n  useEffect(() => {\n    if (okta.hasTokensInUrl()) {\n      okta.authClient.token.parseFromUrl()\n      .then( (data) => {\n        okta.authClient.tokenManager.add('accessToken', data[0]);\n        okta.authClient.tokenManager.add('idToken', data[1]);\n      })\n    }\n    okta.authClient.session.get().then((res) => {\n      if (res.status === 'ACTIVE') {\n        setIsAuthenticated(true);\n        res.user().then((userData) => {\n          setUser(userData.profile);\n          handleSubmit(userData.profile.email);\n        });\n      } else {\n        showLogin();\n      }\n    });\n  }, [isAuthenticated]);\n\n  const logout = () => {\n    okta.authClient.session.close();\n    showLogin();\n    setIsAuthenticated(false);\n\n  }\n\n\n  if (isAuthenticated) {\n    return (\n      <div className=\"App\">\n        <div>Hello {user.firstName} </div>\n        <button onClick={logout}> logout</button>\n      </div>\n    );\n  } else {\n    return (\n      <div className=\"App\" id=\"okta-login-container\">\n      </div>\n    );\n  }\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}